---
html:
  embed_local_images: true
# export_on_save:
#   html: true
---
[toc]
<button id="toggleProofs">Toggle Proofs</button>
<script>
  document.getElementById('toggleProofs').addEventListener('click', function() {
    var details = document.querySelectorAll('details > summary');
    for (var i = 0; i < details.length; i++) {
      if (details[i].textContent.includes('Proof')) {
        details[i].parentElement.open = !details[i].parentElement.open;
      }
    }
  });
</script>

#### 矩阵分解
##### *3.1.1 Lemma:矩阵相抵引理*
> 设矩阵$A, B \in F^{m \times n}$，则以下表述等价：
> (1) $A$与$B$相抵；
> (2) 存在可逆矩阵$P \in F^{m \times m}$和$Q \in F^{n \times n}$使得$A = PBQ$；
> (3) 矩阵$A$与$B$均可通过有限次初等行列变换得到同一个矩阵；
> (4) $\text{rank}(A) = \text{rank}(B)$.

##### *3.1.1 Example:矩阵秩不等式*
> 设$A \in \mathbb{C}^{m \times n}, B \in \mathbb{C}^{n \times p}$，证明：\[\text{rank}(A) + \text{rank}(B) - n \leq \text{rank}(AB) \leq \min(\text{rank}(A), \text{rank}(B)).\]

##### *3.2.1 Theorem: 满秩分解*
> 设$A \in \mathbb{C}^{m \times n}_r(r > 0)$，则存在列满秩矩阵$B$和行满秩矩阵$C$使得$A = BC$。

<details open>
  <summary>Proof:</summary> 

令 \( A = [a_1, \cdots, a_n] \)，则有 \( R(A) = \operatorname{span}(a_1, \cdots, a_n) \) 且 \( \operatorname{rank}(A) = \operatorname{dim}(R(A)) \)，其中 \( a_i \in \mathbb{C}^m, i = 1, \cdots, n \)。任取 \( R(A) \) 的一组基，则 \( a_i \) 必可由基 \( b_1, \cdots, b_r \) 线性表示，即\[
a_i = [b_1, \cdots, b_r] c_i
\] 式中：\( c_i \in \mathbb{C}^r \) 是 \( a_i \) 在基 \( b_1, \cdots, b_r \) 下的坐标，\( i = 1, \cdots, n \).
定义矩阵 \( B = [b_1, \cdots, b_r], C = [c_1, \cdots, c_n] \)，有 
\[A_{m \times n} = [a_1, \cdots, a_n] = [b_1, \cdots, b_r] [c_1, \cdots, c_n] = B_{m \times r}C_{r \times n}\] 式中：\( \operatorname{rank}(B) = \operatorname{dim}(R(B)) = r \)。
又知
\[
\operatorname{rank}(C) \geq \operatorname{rank}(BC)=\operatorname{rank}(A) = r \text{且} \operatorname{rank}(C) \leqslant r
\] 故 \( \operatorname{rank}(C) = r \)。综上所述，矩阵 \( A \) 可分解为列满秩矩阵 \( B \) 和行满秩矩阵 \( C \) 的乘积。
</details>

##### *3.2.3 Theorem: 右逆和左逆*
>矩阵\( A \in \mathbb{C}^{m \times n}(r > 0) \) 有右逆（即存在矩阵 \( B \) 使得 \( AB = I \)）的充分必要条件是 \( A \) 为行满秩矩阵；矩阵 \( A \) 有左逆（即存在矩阵 \( B \) 使得 \( BA = I \)）的充分必要条件是 \( A \) 为列满秩矩阵。
 
<details open>
  <summary>Proof:</summary> 

证明有$A \in \mathbb{C}^{m \times n}$ 有右逆 $ \Leftrightarrow \exists B \in \mathbb{C}^{n \times m}, A_{m \times n} B_{n \times m} = I_{m}$
> 充分性. $ \operatorname{rank}(A)= m \Rightarrow AB = I$.
> 对$A$进行相抵分解, 即$A = P_{m \times m} [I_m, 0]Q_{n \times n}$, 可取$B = Q^{-1} [I_m, 0]^T P^{-1}$, 显然$AB = I$.
必要性. $AB = I \Rightarrow \operatorname{rank}(A) = m$.
$\operatorname{rank}(A) \geq rank(AB) = m$, 显然$A$是满秩的.
</details>

{注}:
1.设 \( A \in \mathbb{C}_r^{r \times n} \)，则 \( A A^H \) 是 \( r \) 阶非奇异矩阵。根据 \( A A^H (A A^H)^{-1} = I \)，得 \( A^H (A A^H)^{-1} \) 是矩阵 \( A \) 的一个右逆。同理，当 \( A \in \mathbb{C}_r^{m \times r} \) 时，\( (A^H A)^{-1} A^H \) 是矩阵 \( A \) 的一个左逆。
2.
当 \( A \) 为可逆矩阵时，其右（左）逆唯一存在，即为 \( A \) 的逆矩阵；
当 \( A \) 为行（列）满秩矩阵（非可逆阵）时，其右（左）逆存在且不唯一；
当 \( A \) 为其它情况时，其右（左）逆不存在。

##### *3.1.1 Proposition: 矩阵转置秩等价*
> (1) $\text{rank}(A) = \text{rank}(A^H A)$。
> (2) $\text{rank}(A^H) = \text{rank}(A A^H)$。
> (3) $\text{rank}(A) = \text{rank}(A^H A) = \text{rank}(A A^H) = \text{rank}(A^H) = \text{rank}(A^H)$。

<details open>
  <summary>Proof:</summary> 

$\forall x \in \mathbb{C}^n, Ax = 0 \Rightarrow A^HAx = 0$显然成立.
$\forall x \in \mathbb{C}^n, A^HAx = 0 \rightarrow x^HA^HAx = 0 \rightarrow (Ax)^H(Ax) = 0 \rightarrow Ax = 0$.
所以$N(A) = N(A^HA)$, 根据秩-零化度定理, $\operatorname{rank}(A) = \operatorname{rank}(A^HA)$. 又由于 $N(A) + R(A^H ) = \mathbb{C}^n$, 所以 $R(A^H) = R(A^HA)$. 令 $A = A^H$, 则有 $R(A) = R(AA^H)$.
> 显然有 $\operatorname{rank}(A) = \operatorname{rank}(AA^H) = \operatorname{rank}(A^H) = \operatorname{rank}(A^H A)$.
</details>

##### *3.3.1 Theorem: LU分解*
> 设$A = [a_{ij}] \in \mathbb{C}^{n \times n}$是非奇异矩阵，则存在唯一的单位下三角矩阵$L$和上三角矩阵$U$使得$A = LU$成立的充分必要条件是$A$的所有顺序主子式均非零，即
\[
\Delta_i(A) = \left| \begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1i} \\
a_{21} & a_{22} & \cdots & a_{2i} \\
\vdots & \vdots & & \vdots \\
a_{i1} & a_{i2} & \cdots & a_{ii}
\end{array} \right| \neq 0, \quad i = 1, \cdots, n
\]

<details open>
  <summary>Proof:</summary> 

见教材P79.
</details>

{注}: 
1. 虽然证明过程较复杂,但实际计算上只需用Gauss消元法求解出$L$和$U$即可.
2. $L$中记录了消元的过程, $U$中记录了消元后的矩阵. 所以$L$中对角线元素为1, $U$中对角线元素为之积为$A$的行列式.

##### *3.3.2 Theorem: LDU Decomposition Theorem*
> 设$A = [a_{ij}] \in \mathbb{C}^{n \times n}$是非奇异矩阵，则存在唯一的单位下三角矩阵$L$，对角矩阵$D$和单位上三角矩阵$U$使得$A = LDU$成立的充分必要条件是$A$的所有顺序主子式均非零，即
\[
\Delta_i(A) = \left| \begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1i} \\
a_{21} & a_{22} & \cdots & a_{2i} \\
\vdots & \vdots & & \vdots \\
a_{i1} & a_{i2} & \cdots & a_{ii}
\end{array} \right| \neq 0, \quad i = 1, \cdots, n
\]分解式$A = LDU$称为矩阵$A$的LDU分解。

{注}: 
1. $L, U$的对角线元素为1, $D$的对角线元素可由$A$的顺序主子式求得, 即 $d_1 = a_{11}, d_i = \frac{\Delta _i(A)}{\Delta _{i-1}(A)}$
2. 非奇异矩阵只是已知条件, 与命题的充分必要性无关. 实际上, 对于奇异矩阵, 其也可以$LDU$分解; 对于非奇异矩阵, 其可能无法$LDU$分解. 但是以下引理说明非奇异矩阵可以通过重排行列顺序后进行$LDU$分解.

##### *3.3.1 Lemma: 非奇异矩阵重排*
> 设$A = [a_{ij}] \in \mathbb{C}^{n \times n}$是非奇异矩阵，则存在排列矩阵$P$使得$PA$的所有顺序主子式均非零。

##### *3.3.1 Corollary: Cholesky 分解*
> 若$n$阶实对称矩阵$A$是正定的，则存在唯一的正上三角矩阵$R$使得$A = R^{\top} R$。

<details open>
  <summary>Proof:</summary> 

由于矩阵$A$是正定的，故其所有顺序主子式均大于0。则$A$可以进行$LDU$分解，即$A = LDU$。由于$A$是实对称矩阵，即$A^\top = U^\top DL^\top = LDU$，由分解的唯一性可得$L = U^{\top}$，则有$A = U^{\top} DU$。令$R ^\top = U^{\top} \sqrt{D}$，则有$A = R^{\top} R$。
唯一性。
假设存在另一正上三角矩阵 $R'$使得$A = R'^{\top} R'$，由于 $R$为正上三角矩阵，则可令 $R'^\top = U'^\top \sqrt[]{D'}$, 则 $A = U'^\top D'U'$, 由分解的唯一性可得 $U = U'$, $D = D'$, 即 $R = R'$。
</details>

##### *3.4.1 Definition: QR 分解*
> 若复方阵$A$可分解为$A = QR$，其中$Q$为酉矩阵，$R$为上三角矩阵，则称矩阵$A$可作$QR$分解（或酉三角分解）。若分解式$A = QR$中，矩阵$A$是实方阵，$Q$为正交矩阵，$R$为上三角矩阵，此时称分解式$A = QR$为正交三角分解。

##### *3.4.1 Theorem: 正交分解*
> 若实方阵$A$满秩，则存在正交矩阵$Q$及正线上三角矩阵$R$满足$A = QR$且分解唯一。

<details open>
  <summary>Proof:</summary> 

记为 \( A = [a_1, \cdots, a_n] \)，则向量组 \( a_1, \cdots, a_n \) 是 \( \mathbb{R}^n \) 空间的一组基。由 Gram-Schmidt 正交化方法知，根据基 \( a_1, \cdots, a_n \) 可构造出 \( \mathbb{R}^n \) 的一组标准正交基 \( z_1, \cdots, z_n \)，且这两组基有如下关系：
\[
[a_1, \cdots, a_n] = [z_1, \cdots, z_n] R \qquad (3.4.1)
\] 式中：\( y_k = a_k - \sum_{i=1}^{k-1} (a_i, z_i) z_i, k = 1, \cdots, n \)，矩阵 \( R \) 定义为\[
R = \begin{bmatrix}
\|y_1\| & (a_2, z_1) & \cdots & (a_n, z_1) \\
 & \|y_2\| & \cdots & (a_n, z_2) \\
 & & \ddots & \vdots \\
0 & & & \|y_n\|
\end{bmatrix}
\] 写成矩阵形式，即 \( A = QR \)，其中，\( Q = [z_1, \cdots, z_n] \)，显然，\( Q \) 是正交矩阵，\( R \) 是正线上三角矩阵。
唯一性证明。
若存在 $A=Q_1R_1 = Q_2R_2$.
令 $ \widetilde{Q} = Q_1^TQ_2,\widetilde{R} = R_1R_2^{-1}$, 显然 $\widetilde{Q} = \widetilde{R}$，由于 $\widetilde{Q}$为正交矩阵，$\widetilde{R}$为正线上三角矩阵，则可记 
$$ \widetilde{R}=\left[\begin{array}{cccc}
\tilde{r}_{11} & \tilde{r}_{12} & \cdots & \tilde{r}_{1 n} \\
& \tilde{r}_{22} & \cdots & \tilde{r}_{2 n} \\
& & \ddots & \vdots \\
& \boldsymbol{O} & & \tilde{r}_{n n}
\end{array}\right]$$ 
由 $\widetilde{R}^\top \widetilde{R} = I$，即
$$
\widetilde{R}^T \widetilde{R} =
\left[\begin{array}{cccc}
\tilde{r}_{11} &  &  \boldsymbol{O} &  \\
\tilde{r}_{12} & \tilde{r}_{22} & &  \\
\vdots & \vdots & \ddots &  \\
\tilde{r}_{1n} & \tilde{r}_{2n} & \cdots & \tilde{r}_{nn}
\end{array}\right] 
\left[\begin{array}{cccc}
\tilde{r}_{11} & \tilde{r}_{12} & \cdots & \tilde{r}_{1 n} \\
& \tilde{r}_{22} & \cdots & \tilde{r}_{2 n} \\
& & \ddots & \vdots \\
& \boldsymbol{O} & & \tilde{r}_{n n}
\end{array}\right] = I$$，对比每一个元素可得$\tilde{r}_{ii}^2 = 1, \tilde{r}_{ij} = 0, i \neq j$，由于所有对角元素都为正，则有$\tilde{r}_{ii} = 1, \tilde{r}_{ij} = 0, i \neq j$，即$\overline{Q} = I, \overline{R} = I$，即 $Q_1 = Q_2, R_1 = R_2$.
</details>

{注}:
1. 对于长方形矩阵 $A_{m \times n}$，其依然可以 $QR$分解。有两种分解形式 $A_{m \times n} = Q_{m \times n}R_{n \times n}$ 和 $A_{m \times n} = Q_{m \times m}R_{m \times n}$。
2. $QR$分解只是将$A$的列向量组转换为标准正交基组，其中$Q$为转化后的标准正交基，$R$记录了转换过程。
3. $QR$分解可以用来求解特征值。
具体思想如下：
对于可逆矩阵$A \in \mathbb{R}^{n \times n}$，令$A_1 = A$，对$A_1$进行$QR$分解，即$A_1 = Q_1R_1$，其中$Q_1$为正交矩阵，$R_1$为上三角矩阵。令$A_2 = R_1Q_1 = Q_1^\top A_1 Q_1$，显然$A_1$和$A_2$相似，其特征值相同。重复如上过程，得$A_{k+1} = Q_k^H A_k Q_k = Q^H A Q$。
通过重复某个过程，可以定义矩阵序列 \(\{A_k, k=1,2,\ldots\}\)。
已知结论：若非奇异矩阵的各特征值具有不同的模值，则$QR$算法定义的矩阵序列收敛于上三角矩阵，则对角线元素即为特征值。

*Example: 非方阵$QR$分解*
> 设 $A = \begin{bmatrix}
    3& 0\\
    0& 1\\
    4& 0
    \end{bmatrix}$，对$A$可进行两种$QR$分解，如下
> $$\boldsymbol{A}=\left[\begin{array}{ll}
3 & 0 \\
0 & 1 \\
4 & 0
\end{array}\right]=\left[\begin{array}{ll}
\frac{3}{5} & 0 \\
0 & 1 \\
\frac{4}{5} & 0
\end{array}\right]\left[\begin{array}{ll}
5 & 0 \\
0 & 1
\end{array}\right] =
\left[\begin{array}{rrr}
\frac{3}{5} & 0 & -\frac{4}{5} \\
0 & 1 & 0 \\
\frac{4}{5} & 0 & \frac{3}{5}
\end{array}\right]\left[\begin{array}{ll}
5 & 0 \\
0 & 1 \\
0 & 0
\end{array}\right]$$


##### *3.4.2 Theorem: 复方阵正交化*
> 设复方阵$A$可逆，则存在酉矩阵$U$及正线上三角矩阵$R$满足$A = UR$且分解唯一。

##### *3.5.1 Theorem: <span id="th3.5.1">Schur定理</span>*
> 任意$n$阶复方矩阵\( A \)相似于上三角矩阵\( \Lambda \)，即存在可逆矩阵\( P \)使得\( A = P^{-1}\Lambda P \)为上三角矩阵，其中上三角矩阵\( \Lambda \)的对角元素是矩阵\( A \)的特征值。 

<details open>
  <summary>Proof:</summary> 

采用数学归纳法证明存在 \( m \) 个可逆矩阵 \( P_1, \cdots, P_m \) 使得\[ P_m^{-1} \cdots P_1^{-1} A P_1 \cdots P_m = \left[ \begin{array}{cc} T_m & C_m \\ 0 & A_m \end{array} \right] \]

当\( m = 1 \)时，令$\lambda_1$为一个特征值，$\eta _1$为对应的特征向量。令利用基的扩充定理找到$\mathbb{C}^n$的一组基并构成列向量，即令$P=[\eta _1, \cdots ,\eta _n]$，则有$AP = A[\eta _1, \cdots ,\eta _n]=[\lambda _1\eta _1, \cdots ,A\eta _n]$，即有
\[ P_1^{-1} A P_1 = \left[ \begin{array}{ll} \lambda_1 & C_1 \\ 0 & A_1 \end{array} \right] \]

由于$A$与$P^{-1}AP$相似，有\( A_1 \in \mathbb{C}^{(n-1) \times (n-1)} \) 的特征值为 \( \lambda_2, \cdots, \lambda_n \)。
假设当 \( m = k \in \{1, \cdots, n-2\} \) 时存在可逆矩阵 \( P_1, \cdots, P_k \) 使得
\[ P_k^{-1} \cdots P_1^{-1} A P_1 \cdots P_k = \left[\begin{array}{ll} T_k & C_k \\ 0 & A_k \end{array}\right] \]

当 \( m = k+1 \) 时，仿照 \( P_1 \) 构造方法知，存在 \( n-k \) 阶矩阵 \( V_{k+1} \) 使得
\[ V_{k+1}^{-1} A_k V_{k+1} = \left[\begin{array}{cc} \lambda_{k+1} & C_{k+1} \\ 0 & A_{k+1} \end{array}\right] \]

定义 \( P_{k+1} = \left[\begin{array}{cc} I_k & O \\ O & V_{k+1} \end{array}\right] \) ，则有
\[ P_{k+1}^{-1} P_k^{-1} \cdots P_1^{-1} A P_1 \cdots P_k P_{k+1} = \left[\begin{array}{cc} T_{k+1} & C_{k+1} \\ O & A_{k+1} \end{array}\right] \]

因此，存在 \( n-1 \) 个可逆矩阵 \( P_1, \cdots, P_{n-1} \) 使得
\[ P_{n-1}^{-1} \cdots P_1^{-1} A P_1 \cdots P_{n-1} = \left[\begin{array}{cc} T_{n-1} & C_{n-1} \\ 0 & \lambda_n \end{array}\right] \]

记 \( P = P_1 \cdots P_{n-1} \) ，则上式右端为上三角矩阵。证毕。
</details>

{注}：
1. 当$m=1$时，一定可以找到特征值的原因是根据代数基本定理，但是在实数域中不一定成立。
    > 代数基本定理：任何复系数一元$n$次多项式 方程在复数域上至少有一根($n \geq 1$)，由此推出，$n$次复系数多项式方程在复数域内有且只有$n$个根（重根按重数计算）。
2. 这里数域为$\mathbb{C}$，因为实数域中矩阵可能没有特征值。

##### *3.5.3 Theorem: 实方正Schur's引理*
> 设$A \in \mathbb{R}^{n \times n}$的特征值均为实数，则存在正交矩阵$Q$使得
\[ Q^T A Q = Q^{-1} A Q = \begin{bmatrix} \lambda_1 & & * \\ & \ddots & \\ 0 & & \lambda_n \end{bmatrix} \]

<details open>
  <summary>Proof:</summary> 

证明可由<a href="#th3.5.1">定理3.5.1</a>显然得到。
</details>

##### *3.5.2 Theorem: <span id="th3.5.2">Schur's 引理</span>*
> 任意复方阵$A$酉相似于上三角矩阵$\Lambda$，即存在一酉矩阵$U$使得$\Lambda = U^{\text{H}} AU$为上三角矩阵。

<details open>
  <summary>Proof:</summary> 

只需要对<a href="#th3.5.1">定理3.5.1</a>中的$P$进行$QR$分解即可得到。
</details>

##### *3.5.2 Lemma: 三角矩阵的乘积*
> 若矩阵$A, B$均为上三角矩阵，则矩阵$A \pm B, AB, A^{-1}$也为上三角矩阵。

<details open>
  <summary>Proof:</summary> 

$A+B$显然是上三角的。
下面证明$AB$和$A^{-1}$是上三角的。
$$
C = AB = \begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
0 & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & a_{nn}
\end{bmatrix} 
\begin{bmatrix}
b_{11} & b_{12} & \cdots & b_{1n} \\
0 & b_{22} & \cdots & b_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & b_{nn}
\end{bmatrix}
$$

$c_{ij} = \sum_{k=1}^n a_{ik}b_{kj}$，当$i > j$时，$c_{ij} = 0$，故$C$为上三角矩阵。

当$A$为上三角时，$A_{ij} = 0, \forall i < j $
$$
A^{-1} = \frac{A^*}{|A|} = \frac{1}{|A|} \begin{bmatrix}
A_{11} & A_{21} & \cdots & A_{n1} \\
A_{12} & A_{22} & \cdots & A_{n2} \\
\vdots & \vdots & \ddots & \vdots \\
A_{n1} & A_{n2} & \cdots & A_{nn}
\end{bmatrix}
$$
故$A^{-1}$是上三角的。
</details>

##### *3.5.1 Definition: 矩阵多项式* 
> 设$A \in \mathbb{C}^{n \times n}$，$\varphi(\lambda) = a_n \lambda^n + a_{n-1} \lambda^{n-1} + \cdots + a_1 \lambda + a_0$，其中$a_i \in \mathbb{C}$（$i = 0, 1, \cdots, n$）是数域$\mathbb{C}$上的多项式，则
\[ \varphi(A) = a_n A^n + a_{n-1} A^{n-1} + \cdots + a_1 A + a_0 I \]
>
>称为矩阵多项式。

##### *3.5.1 Corollary: <span id="co3.5.1">矩阵多项式的特征值</span>*
> 设矩阵$A \in \mathbb{C}^{n \times n}$的$n$个特征值为$\lambda_1, \cdots, \lambda_n$，$\varphi(\lambda)$为任一多项式，则矩阵多项式$\varphi(A)$的$n$个特征值为$\varphi(\lambda_1), \cdots, \varphi(\lambda_n)$。

<details open>
  <summary>Proof:</summary> 

根据<a href="#th3.5.2">定理3.5.2</a>，存在一酉矩阵$U$使得$U^H A U = \Lambda$，其中$\Lambda$为上三角矩阵，其对角线元素为矩阵$A$的特征值，记为$\lambda_1, \cdots, \lambda_n$。注意到
\[ \varphi(A) = \varphi(U \Lambda U^H) = U \varphi(\Lambda) U^H \]
 
式中：上三角矩阵$\varphi(\Lambda)$的对角线元素为$\varphi(\lambda_1), \cdots, \varphi(\lambda_n)$。由于$\varphi(A)$酉相似于上三角矩阵$\varphi(\Lambda)$，故矩阵多项式$\varphi(A)$的$n$个特征值为$\varphi(\lambda_1), \cdots, \varphi(\lambda_n)$。证毕。
</details>

{注}：
由于对$A$的属于$\lambda _1$的特征向量$\alpha _1$，有$A^k\alpha _1 = \lambda^k _1 \alpha _1, k=1,\cdots,n$，则$$\varphi(A)\alpha _1 = a_n A^n \alpha _1 + \cdots + a_1 A \alpha _1 + a_0 \alpha _1 = a_n \lambda^n _1 \alpha _1 + \cdots + a_1 \lambda _1 \alpha _1 + a_0 \alpha _1 = \varphi(\lambda _1) \alpha _1$$

显然有$n$阶矩阵$A$的属于特征值$\lambda_i$的特征向量$\alpha_i$也是$\varphi(A)$的属于特征值$\varphi(\lambda_i)$的特征向量。


##### *3.5.4 Theorem: Hamilton-Cayley 定理*
> 设矩阵$A \in \mathbb{C}^{n \times n}$的特征多项式为$f_A(\lambda) = \det(\lambda I - A)$，则$f(A) = 0$。

<details open>
  <summary>Proof:</summary> 

设矩阵$A$的特征多项式为$f_A(\lambda) = \lambda ^n + a_{n-1}\lambda ^{n-1} + \cdots + a_0$。由[定理3.5.2](#th3.5.2)知，存在酉矩阵$U$使得$U^H A U = \Lambda$，其中$\Lambda$为上三角矩阵，其对角元素为$\lambda_1, \lambda_2, \ldots, \lambda_n$。则矩阵多项式$f(A)$可写成
\[ 
  \begin{array}{l}
  f_A(A) = A^n + a_{n-1}A^{n-1} + \cdots + a_0I 
   &= U \Lambda^n U^H + a_{n-1}U \Lambda^{n-1} U^H + \cdots + a_0I \\
   &= U \underset{f_A(\lambda_{1,\cdots ,n}) = 0}{\boxed{(\Lambda^n + a_{n-1}\Lambda^{n-1} + \cdots + a_0I)}}U^H = 0 
  \end{array}
\]
</details>

##### *3.5.3 Corollary: 矩阵多项式表示逆*
> 设复方阵$A$可逆，其特征多项式为$f_A(\lambda) = \lambda^n + a_{n-1} \lambda^{n-1} + \cdots + a_1 \lambda + a_0$，则矩阵$A$的逆矩阵计算公式为
\[ A^{-1} = -\frac{1}{a_n} \left( A^{n-1} + a_{n-1} A^{n-2} + \cdots + a_1 I \right) \]

{注}: 该结论说明，矩阵$A$的逆矩阵可以通过低阶矩阵表示。

##### *3.5.2 Definition: 零化多项式*
> 给定复方阵$A \in \mathbb{C}^{n \times n}$，若存在多项式$g(\lambda)$使得$g(A) = 0$，则称$g(\lambda)$为$A$的零化多项式。

##### *3.5.3 Definition: 最小多项式*
> 设复方阵$A$的零化多项式中次数最小的首1多项式称为$A$的最小多项式，记为$m_A(\lambda)$。

##### *3.5.5 Theorem: 最小多项式性质*
> 设矩阵$A \in \mathbb{C}^{n \times n}$，则
> 1. 矩阵$A$的最小多项式$m_A(\lambda)$是唯一的，且可整除$A$的任一零化多项式，特别地，有$m_A(\lambda) \mid f_A(\lambda)$。
> 2. 矩阵$A$的特征多项式$f_A(\lambda)$与最小多项式$m_A(\lambda)$具有相同的根（不计重数）。

<details open>
  <summary>Proof:</summary> 

(1) 对任意多项式 \( g(\lambda) \) 和 \( h(\lambda) \)，必存在多项式 \( q(\lambda) \) 以及多项式 \( r(\lambda) \) 使得
\[ g(\lambda) = h(\lambda) q(\lambda) + r(\lambda)\]

式中：\( r(\lambda) = 0 \) 或 \( \deg[r(\lambda)] < \deg[h(\lambda)] \)。该结论可由多项式除法定理得到，把 \( g(\lambda) \) 除以 \( h(\lambda) \) 得到商 \( q(\lambda) \) 和余式 \( r(\lambda) \)。
若 \( g(\lambda) \) 和 \( h(\lambda) \) 分别定义为矩阵的特征多项式 \( f_A(\lambda) \) 和最小多项式 \( m_A(\lambda) \)，则代入上式得 \( f_A(\lambda) = m_A(\lambda) q(\lambda) + r(\lambda)\)，则有$f_A(A)= m_A(A)g(A) + r(A) = 0$，得\( r(A) = 0 \)。
现在说明$r(\lambda ) = 0$。若$r(\lambda) \neq 0$，则存在一个次数更低的多项式\( r(\lambda) \)使得\( r(A) = 0\)，与\( m_A(\lambda) \)为最小多项式矛盾，故\( r(\lambda) = 0, f_A(\lambda) = m_A(\lambda) q(\lambda)\)，即\( m_A(\lambda) \mid f_A(\lambda) \)。
下面说明\( m_A(\lambda) \) 是唯一的。
若存在另一多项式 \( m'_A(\lambda) \) 使得 \( m'_A(\lambda) \mid f_A(\lambda) \)，则必然有 \( \deg m'_A(\lambda) = \deg m_A(\lambda)\)，则$(m'_A(\lambda) - m_A(\lambda ))$也必然是零化多项式且 $\deg (m'_A(\lambda) - m_A(\lambda )) < \deg m_A(\lambda )$，与已知矛盾，故 \( m_A(\lambda) \) 是唯一的。

(2) $m_A(\lambda )$的根显然一定是$f_A(\lambda )$的根，下面说明 $f_A(\lambda )$的根也是$m_A(\lambda )$的根。
设 \( \lambda_i \) 是矩阵 \( A \) 的特征值，\( x_i \) 是属于 \( \lambda_i \) 的特征向量。根据<a href="#co3.5.1">推论3.5.1</a>知，\( m_A(\lambda_i) \) 是矩阵多项式 \( m_A(A) \) 的特征值，且 \( x_i \) 是属于 \( m_A(A) \) 的特征向量，即
\[ m_A(A) x_i = m_A(\lambda_i) x_i \]

由于 \( m_A(A) \) 是矩阵 \( A \) 的零化多项式，故 \( m_A(A) = 0 \)，进而有 \( m_A(\lambda_i) x_i = 0 \)。又知 \( x_i \) 是非零向量，故 \( m_A(\lambda_i) = 0 \)，即$f_A(\lambda )$的根也是$m_A(\lambda )$的根。证毕。
</details>

##### *3.6.1 Definition: 单纯矩阵*
> 若$n$阶复方阵$A$相似于对角矩阵，则矩阵$A$称为可对角化矩阵（或单纯矩阵）。

##### *3.6.1 Theorem: 可对角化条件*
> 设矩阵$A \in \mathbb{C}^{n \times n}$的全部互异特征根为$\lambda_1, \cdots, \lambda_m$（其中$m \leqslant n$），则以下表达等价：
> 1. $A$是单纯矩阵
> 2. $A$有$n$个线性无关的特征向量
> 3. 特征值$\lambda_i$($i=1, \cdots, m$)的代数重数等于其几何重数
> 4. $\sum_{i=1}^{m} \operatorname{dim} E(\lambda_i) = n$
> 5. 最小多项式$m_A(\lambda)$无重根

<details open>
  <summary>Proof:</summary> 

(1)~(4)根据实矩阵可对角化条件推广而得。
下面证明(5)。
(1) $\Rightarrow $ (5).
由于矩阵 \( A \) 是单纯矩阵，所以存在一个可逆矩阵 \( P \) 使得 \( P^{-1}AP = \Lambda  \)，其中$\Lambda $是对角矩阵。
设$\lambda  _1, \cdots, \lambda  _s $为互异特征值，考虑如下矩阵多项式
> $$
g(A) = (A - \lambda_1 I) \cdots (A - \lambda_m I) = P^{-1} \underset{\triangleq B   }{\boxed{(\Lambda - \lambda_1 I) \cdots (\Lambda - \lambda_m I)}} P
$$
式中

$$
\Lambda = \begin{bmatrix}
\boxed{\lambda_1} & (d_1个)  \\
& \boxed{\lambda_1}  \\
& & \ddots & \\
& & & \boxed{\lambda_s} & (d_s个) \\
& & & & \boxed{\lambda_s}
\end{bmatrix}
$$

下面考察矩阵矩阵$B$。
$$
B = \begin{bmatrix}
0 \\
& 0 \\
& & \ddots\\
& & & \lambda_s - \lambda_1\\
& & & & \lambda_s - \lambda_1
\end{bmatrix}
\cdots 
\begin{bmatrix}
\lambda _1 - \lambda _s \\
& \lambda _1 - \lambda _s \\
& & \ddots\\
& & & 0 \\
& & & & 0
\end{bmatrix} = 0
$$ 

故$g(A) = 0$，所以$g(\lambda )$为最小多项式，且无重根。  

(5) $\Rightarrow $ (4).
设矩阵 $A$ 的最小多项式为 $m_A(\lambda) = (\lambda - \lambda_1) \cdots (\lambda - \lambda_m)$, 则
$$ m_A(A) = (A - \lambda_1 I) \cdots (A - \lambda_m I) = 0$$

由<a href="./线性代数.html#th2.6.5">矩阵秩乘积</a>的推论有:
$$\boxed{\operatorname{rank}(A - \lambda_1 I) + \cdots + \operatorname{rank}(A - \lambda_m I) \leq (m - 1)n}$$

则有：
$$ \operatorname{dim} E(\lambda_1) + \cdots + \operatorname{dim} E(\lambda_m) = (n - \operatorname{rank}(A - \lambda_1 I)) + \cdots + (n - \operatorname{rank}(A - \lambda_m I)) \geq n  $$

由于 $m$ 个特征子空间的和空间是 $\mathbb{C}^n$ 空间的线性子空间, 因此$\sum_{i=1}^m \operatorname{dim} E(\lambda_i) = n$. 证毕.
</details>

##### *3.6.1 Corollary*
> 若复方阵$A$的零化多项式$g(\lambda)$无重根，则矩阵$A$是单纯矩阵。

##### *3.6.2 Corollary*
> 若$n$阶复方阵$A$恰好有$n$个互异特征值，则它必可对角化；反之则不然。

{注}：上述两个推论仅是复方阵$A$为单纯矩阵的充分条件而非必要条件。

##### *3.6.\* Theorem: 酉相似矩阵的特征空间*
> 设存在酉矩阵 $U$ 使得 $U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$。则$A$的不同特征值的特征子空间正交。

<details open>
  <summary>Proof:</summary> 

令 $U = [u_1, \cdots, u_n]$，则有
$$
A[u_1, \cdots, u_n] = [Au_1, \cdots, Au_n] = [u_1, \cdots, u_n] \operatorname{diag}(\lambda_1, \cdots, \lambda_n)
$$

显然有 $Au_i = \lambda_i u_i$，即 $u_i$ 是属于 $\lambda_i$ 的特征向量。对于酉矩阵，其列向量$u_i, u_j$两两正交。
考察特征子空间
$$E(\lambda_i) = \operatorname{span}\{u_{i_{d_1}}, \cdots, u_{i_{d_i}}\}, E(\lambda_j) = \operatorname{span}\{u_{j_{d_1}}, \cdots, u_{j_{d_j}}\} (i \neq j)$$

由于$u_i, u_j$两两正交，故$E(\lambda_i)$与$E(\lambda_j)$正交。证毕。
</details>

##### *3.6.3 Corollary: <span id="co3-6-3">酉矩阵的对角化</span>*
> 设矩阵$A \in \mathbb{C}^{n \times n}$，则$A$是Hermite矩阵当且仅当$A$的所有特征值$\lambda_1, \cdots, \lambda_n$为实数，且存在酉矩阵$U \in \mathbb{C}^{n \times n}$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$。

<details open>
  <summary>Proof:</summary> 

充分性。
若$A$的所有特征值$\lambda_1, \cdots, \lambda_n$为实数，且存在酉矩阵$U \in \mathbb{C}^{n \times n}$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$，对其两端取共轭转置有$U^H A^H U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n) = U^H A U$，则$A = A^H$，故$A$是Hermite矩阵。
必要性。
若$A$是Hermite矩阵，由[Schur定理](#th3.5.1)可得$A$酉相似于上三角矩阵，即存在酉矩阵$U$使得$U^H A U = \Lambda$，其中$\Lambda $对角线元素为$A$的特征值。对其两端取共轭转置有 $U^H A^H U = \overline{\Lambda } = U^H A U = \Lambda $，则有$A$的特征值为实数。证毕。
</details>

##### *3.6.4 Corollary: 正交矩阵的对角化*
> 设矩阵$A \in \mathbb{R}^{n \times n}$，则$A$是实对称矩阵当且仅当$A$的所有特征值$\lambda_1, \cdots, \lambda_n$为实数，且存在正交矩阵$Q \in \mathbb{R}^{n \times n}$使得$Q^{\top} A Q = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$。

##### *3.6.2 Definition: 正规矩阵*
> 设矩阵$A \in \mathbb{C}^{n \times n}$，若$A^H A = A A^H$，则称$A$为正规矩阵（或规范矩阵）。

##### *3.6.2 Theorem: 正规矩阵的对角化*
> 复方阵$A$是正规矩阵当且仅当$A$酉相似于对角矩阵，即$A^H A = A A^H$当且仅当存在酉矩阵$U$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$。

<details open>
  <summary>Proof:</summary> 

充分性。
由 $U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$ $\Rightarrow$ $A^H A = A A^H$ 。
若存在酉矩阵$U$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$，则有$A^H A = U^H \operatorname{diag}(\lambda_1, \cdots, \lambda_n) \operatorname{diag}(\lambda_1, \cdots, \lambda_n) U = U^H \operatorname{diag}(\lambda_1, \cdots, \lambda_n)^2 U = U^H \operatorname{diag}(\lambda_1^2, \cdots, \lambda_n^2) U = A A^H$，故$A$是正规矩阵。
必要性。
由 $A^H A = A A^H$ $\Rightarrow $ $U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$。
由<a href="#co3-6-3">定理3.6.3</a>可得$A$酉相似于上三角矩阵，即存在酉矩阵$U$使得$U^H A U = \Lambda $，其中$\Lambda $为上三角矩阵。则有 
$$
\begin{array}{l}
A = U \Lambda U^H, A^H = (U \Lambda U^H)^H = U \Lambda^H U^H \\
A^H A = U\Lambda^H \Lambda U^H = AA^H = U \Lambda \Lambda^H U^H
\end{array} \Rightarrow  \Lambda^H \Lambda = \Lambda \Lambda^H
$$

令
$$
\Lambda = 
\begin{bmatrix}
\lambda_{1} & a_{12} & \cdots & a_{1 n} \\
0 & \lambda_{2} & \cdots & a_{2 n} \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 0 & \lambda_{n}
\end{bmatrix}
$$

则
\[
\begin{array}{l}
\Lambda^H \Lambda =
\begin{bmatrix}
\bar{\lambda}_{1} & 0 & \cdots & 0 \\
\bar{a}_{12} & \bar{\lambda}_{2} & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
\bar{a}_{1 n} & \bar{a}_{2 n} & \cdots & \bar{\lambda}_{n}
\end{bmatrix}
\begin{bmatrix}
\lambda_{1} & a_{12} & \cdots & a_{1 n} \\
0 & \lambda_{2} & \cdots & a_{2 n} \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 0 & \lambda_{n}
\end{bmatrix}\\
\Lambda \Lambda^H = 
\begin{bmatrix}
\lambda_{1} & a_{12} & \cdots & a_{1 n} \\
0 & \lambda_{2} & \cdots & a_{2 n} \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 0 & \lambda_{n}
\end{bmatrix}
\begin{bmatrix}
\bar{\lambda}_{1} & 0 & \cdots & 0 \\
\bar{a}_{12} & \bar{\lambda}_{2} & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
\bar{a}_{1 n} & \bar{a}_{2 n} & \cdots & \bar{\lambda}_{n}
\end{bmatrix}
\end{array}
\]

根据上式左右两端矩阵对角线元素相等，得
\[
\begin{gathered}
\left|\lambda_1\right|^2 = \left|\lambda_1\right|^2 + \left|a_{12}\right|^2 + \cdots + \left|a_{1 n}\right|^2 \\
\left|\lambda_2\right|^2 + \left|a_{12}\right|^2 = \left|\lambda_2\right|^2 + \left|a_{23}\right|^2 + \cdots + \left|a_{2 n}\right|^2 \\
\vdots \\
\left|\lambda_n\right|^2 + \left|a_{1 n}\right|^2 + \left|a_{2 n}\right|^2 + \cdots + \left|a_{(n-1) n}\right|^2 = \left|\lambda_n\right|^2
\end{gathered}
\]

依次求解得 \(a_{12} = \cdots = a_{1 n} = 0, a_{23} = \cdots = a_{2 n} = 0, \cdots, a_{(n-1) n} = 0\)。由此，上三角矩阵 \(\Lambda\) 退化为对角矩阵，即 \(A\) 酉相似于对角矩阵 \(\Lambda\)。
</details>

##### *3.6.5 Corollary*
> 复方阵$A$是正规矩阵当且仅当$A$有$n$个特征向量构成$\mathbb{C}^n$空间的一组标准正交基，且属于$A$的不同特征值的特征向量正交。

##### *3.6.6 Corollary*
> 实方阵$A$是正交矩阵当且仅当$A$的所有特征值的模值为1，且存在酉矩阵$U$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$，其中$\lambda_1, \cdots, \lambda_n$是$A$的$n$个特征值。

##### *3.6.7 Corollary*
> 设矩阵$A \in \mathbb{C}^{n \times n}$，则$A$是酉矩阵当且仅当$A$的所有特征值的模为1，且存在酉矩阵$U$使得$U^H A U = \operatorname{diag}(\lambda_1, \cdots, \lambda_n)$，其中$\lambda_1, \cdots, \lambda_n$是$A$的$n$个特征值。
